/*! Puppetglasses - v0.1.0 - 2015-03-15
* https://github.com/tosmi/puppetglasses
* Copyright (c) 2015 Toni Schmidbauer; Licensed GPLv3 */
window.puppetglassesConfig={},puppetglassesConfig.puppetdb_url="http://localhost:2080/v3";var Puppetglasses=function(){"use strict";function a(){this.config=puppetglassesConfig}function b(a,b){for(var c=[],d=0;d<a.length;d++)c.push(a[d].name);b(c)}function c(a){e.row.add([a.type,a.title,d(a.parameters)])}function d(a){var b="";for(var c in a)a.hasOwnProperty(c)&&(b+=c+"=>"+a[c]+"\n");return b}a.prototype.findNodes=function(a,c){var d=this.config.puppetdb_url+'/nodes?query=["~","name","'+a.term+'"]';$.getJSON(d).done(function(a){b(a,c)})},a.prototype.findResources=function(){var a=$("#hostname").val(),b=this.config.puppetdb_url+"/nodes/"+a+"/resources",c=this;$.get(b).done(function(a){c.displayResources(a)})},a.prototype.displayResources=function(a){e.clear(),a.map(c),e.search("").columns().search("").draw(),this.addTooltips(),$("#resources").show()},a.prototype.addTooltips=function(){e.column(2).visible(!0),$("#resource_table tbody tr").each(function(){var a=$("td",this)[2],b=$(a).text();this.setAttribute("title",b)}),e.column(2).visible(!1)};var e=$("#resource_table").DataTable({search:{caseInsensitive:!1},columnDefs:[{targets:2,searchable:!1}]});return a}();$(document).ready(function(){var a=new Puppetglasses;$("#hostname").autocomplete({source:function(b,c){a.findNodes(b,c)}}),$("#search").click(function(){a.findResources()}),$("#resources").hide(),$("#resource_table").on("draw.dt",function(){a.addTooltips()})});